{% extends '_base.html' %}
{% load static %}

{% block header_css %}
<link href="https://cdn.jsdelivr.net/npm/simplemde@1.11.0/dist/simplemde.min.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/articles.css' %}">
{% endblock %}

{% block body %}

<div class="articles-container">
    {% block article-body %}
    {% endblock %}
</div>

{% block footer_js %}
<script>
    document.getElementById("markdown-input").addEventListener("input", function() {
        const content = this.value;

        fetch("{% url 'articles:preview_markdown' %}", {
            method: "POST",
            headers: {
                "X-CSRFToken": "{{ csrf_token }}",
                "Content-Type": "application/x-www-form-urlencoded",
            },
            body: new URLSearchParams({ content }),
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("markdown-preview").innerHTML = data.html;
        });
    });

    // Modal Logic
    const helpBtn = document.getElementById("help-btn");
    const helpModal = document.getElementById("help-modal");
    const closeBtn = document.getElementById("close-btn");

    helpBtn.addEventListener("click", () => {
        helpModal.style.display = "flex";
    });

    closeBtn.addEventListener("click", () => {
        helpModal.style.display = "none";
    });

    window.addEventListener("click", (e) => {
        if (e.target === helpModal) {
            helpModal.style.display = "none";
        }
    });
</script>
{% endblock %}

{% endblock %}

